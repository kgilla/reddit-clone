(this["webpackJsonpreddit-clone-frontend"]=this["webpackJsonpreddit-clone-frontend"]||[]).push([[0],{103:function(e,t,n){},187:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){},197:function(e,t,n){},198:function(e,t,n){},199:function(e,t,n){},200:function(e,t,n){},204:function(e,t){},206:function(e,t){},238:function(e,t){},239:function(e,t){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},308:function(e,t,n){},309:function(e,t,n){},408:function(e,t,n){},417:function(e,t,n){},418:function(e,t,n){},419:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},422:function(e,t,n){},423:function(e,t,n){},424:function(e,t,n){},425:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n(1),a=n.n(r),c=n(170),o=n.n(c),i=n(5),l=n(13),u=(n(187),n(10)),d=n(15),b=n(2),j=n.n(b),m=n(3),p=n(4),h=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,s,r,a=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",e.prev=1,e.next=4,fetch(t,{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 4:return s=e.sent,e.next=7,s.json();case 7:return r=e.sent,e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(m.a)(j.a.mark((function e(t,n,s){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,s){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(j.a.mark((function e(t,n,s){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"put",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 3:return r=e.sent,e.abrupt("return",r);case 7:e.prev=7,e.t0=e.catch(0),console.log({error:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,s){return e.apply(this,arguments)}}(),x=function(){var e=Object(m.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),v="https://api-reddit-clone.herokuapp.com",g=Object(r.createContext)();function w(e){var t=e.children,n=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(null),c=Object(p.a)(a,2),o=c[0],i=c[1],l=function(e){e.forEach((function(e){var t={};!0!==e.value&&!1!==e.value||(t.id=e.post?e.post:e.comment,t.value=e.value?"up":"down",localStorage.setItem(t.id,t.value))}))},b=function(){var e=Object(m.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat(v,"/api/users/login"),{username:t,password:n});case 3:if((r=e.sent).user){e.next=8;break}return e.abrupt("return",r);case 8:if(!r.user){e.next=13;break}return l(r.votes),s(r.user),i(r.token),e.abrupt("return",{user:r.user});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(m.a)(j.a.mark((function e(t,n,s){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat(v,"/api/users/create"),{username:t,password:n,email:s});case 3:return r=e.sent,e.abrupt("return",r);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,s){return e.apply(this,arguments)}}(),O=function(){s(null),i(null),localStorage.clear()},x=function(e){s(Object(d.a)(Object(d.a)({},n),{},{subscriptions:[].concat(Object(u.a)(n.subscriptions),[e])}))},g=function(e){var t=n.subscriptions.filter((function(t){return t!==e}));s(Object(d.a)(Object(d.a)({},n),{},{subscriptions:t}))};return Object(r.useEffect)((function(){var e=function(e){s(e||!1)};return function(){return e()}}),[]),{user:n,token:o,login:b,signup:h,logout:O,subscribe:x,unsubscribe:g}}();return Object(s.jsx)(g.Provider,{value:n,children:t})}var N=function(){return Object(r.useContext)(g)};var y=Object(r.createContext)();function k(e){var t=e.children,n=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(!1),c=Object(p.a)(a,2),o=c[0],i=c[1];return{message:n,showMessage:o,changeMessage:function(e){s(e),i(!0),setTimeout((function(){i(!1)}),5e3)}}}();return Object(s.jsx)(y.Provider,{value:n,children:t})}var C=function(){return Object(r.useContext)(y)};n(189),n(190),n(191);var S=function(e){var t=e.data,n=e.children,r=t.onClick,a=t.href,c=t.title;return Object(s.jsxs)(i.b,{to:a,className:"sidenav-item",onClick:r,children:[n,Object(s.jsx)("span",{className:"sidenav-item-heading",children:c})]})},_=n(435),P=n(437),D=n(433),E=n(434),M=n(432),q=n(430),I=n(431),A=n(436),L=function(e){var t=e.logout,n=N(),a=Object(r.useState)(null),c=Object(p.a)(a,2),o=c[0],i=c[1],l=Object(r.useState)(!1),u=Object(p.a)(l,2),d=u[0],b=u[1];Object(r.useEffect)((function(){var e=function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(v,"/api/s/user"),n.token);case 3:t=e.sent,i(t.subs),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();n.token?e():i(null)}),[n.token,d]);var f=function(){b(!d)},O=function(e,t){return{href:e,title:t,onClick:f}};return Object(s.jsxs)("div",{id:"nav-subs",children:[Object(s.jsxs)("button",{id:"sub-nav-button",onClick:f,children:[Object(s.jsx)(q.a,{className:"menu-icon"}),Object(s.jsx)("span",{className:"sidenav-button-text",children:"Menu"})]}),d?Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{id:"sidenav-overlay",onClick:f}),Object(s.jsxs)("div",{id:"sub-sidenav",className:d?"sidenav-show":"sidenav-hide",children:[Object(s.jsxs)("header",{className:"sidenav-profile-header",children:[Object(s.jsx)("h5",{className:"sidenav-username",children:n.user.username}),Object(s.jsx)("button",{className:"close-button",onClick:f,children:Object(s.jsx)(I.a,{className:"close-button-icon"})})]}),Object(s.jsxs)("div",{className:"sidenav-section",children:[Object(s.jsx)(S,{data:O("/users/".concat(n.user.username),"Profile"),children:Object(s.jsx)(M.a,{className:"sidenav-item-icon"})}),Object(s.jsx)(S,{data:O("/","Home"),children:Object(s.jsx)(D.a,{className:"sidenav-item-icon"})}),Object(s.jsx)(S,{data:O("/s/all","All"),children:Object(s.jsx)(E.a,{className:"sidenav-item-icon"})}),Object(s.jsx)(S,{data:O("/s/browse","Browse Communities"),children:Object(s.jsx)(_.a,{className:"sidenav-item-icon"})})]}),Object(s.jsxs)("div",{className:"sidenav-section",children:[Object(s.jsx)("h6",{className:"sidenav-heading",children:"My Communities"}),o.length>0?o.map((function(e){return Object(s.jsx)(S,{data:O("/s/".concat(e._id),e.name),children:Object(s.jsx)("div",{className:"sidenav-item-circle",style:e.color?{backgroundColor:e.color}:null})},e._id)})):null]}),Object(s.jsxs)("div",{className:"sidenav-section",children:[Object(s.jsx)("h6",{className:"sidenav-heading",children:"Other"}),Object(s.jsx)(S,{data:O("/submit","Create Post"),children:Object(s.jsx)(A.a,{className:"sidenav-item-icon"})}),Object(s.jsx)(S,{data:O("/s/create","Create Community"),children:Object(s.jsx)(P.a,{className:"sidenav-item-icon"})})]}),Object(s.jsx)("div",{className:"sidenav-button-box",children:Object(s.jsx)("button",{className:"button-outline logout-button",onClick:t,children:"Logout"})}),Object(s.jsx)("div",{className:"blue-box"})]})]}):null]})},R=function(){var e=N(),t=Object(l.g)();return Object(s.jsx)("div",{id:"nav-container",children:Object(s.jsxs)("nav",{id:"top-nav",children:[Object(s.jsx)(i.b,{to:"/",id:"nav-brand",children:"S/eddit"}),Object(s.jsx)("div",{id:"nav-sub-container",children:e.user?Object(s.jsx)(L,{logout:function(){e.logout(),t.push("/")}}):Object(s.jsxs)("div",{className:"nav-buttons",children:[Object(s.jsx)(i.b,{to:"/signup",className:"button-outline nav-button",children:"Sign Up"}),Object(s.jsx)(i.b,{to:"/login",className:"button-filled nav-button",children:"Log In"})]})})]})})},F=(n(197),n(440));function T(){var e=Object(r.useState)({width:void 0,height:void 0}),t=Object(p.a)(e,2),n=t[0],s=t[1];return Object(r.useEffect)((function(){function e(){s({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}var U=n(32),V=n.n(U),B=n(438),Y=n(439),J=(n(198),function(e){var t=e.score,n=e.item,a=e.type,c=e.handleChoice,o=N(),i=Object(r.useState)(o.user?localStorage.getItem(n._id):null),l=Object(p.a)(i,2),u=l[0],d=l[1],b=function(e){var t=e.currentTarget.name;u&&u===t?j(null,"up"===t?-1:1):j(t,u&&u!==t?"up"===t?2:-2:"up"===t?1:-1)},j=function(e,t){d(e),null===e?localStorage.removeItem(n._id):localStorage.setItem(n._id,e),c(e,t)};return Object(s.jsxs)("div",{className:"post"===a?"post-score-box":"score-box",children:[Object(s.jsx)("button",{name:"up",onClick:o.user?b:null,className:"invis-button",children:Object(s.jsx)(B.a,{className:"score-arrow up-arrow",style:"up"===u?{color:"var(--orange)"}:null})}),"post"===a?Object(s.jsx)("span",{className:"score-number",children:t}):null,Object(s.jsx)("button",{name:"down",onClick:o.user?b:null,className:"invis-button",children:Object(s.jsx)(Y.a,{className:"score-arrow down-arrow",style:"down"===u?{color:"var(--blue)"}:null})})]})}),z=(n(199),function(e){var t=e.title,n=e.message,r=e.onSubmit,a=function(e){"confirm"===e.target.name?r(!0):r(!1)};return Object(s.jsx)("div",{className:"alert-overlay",children:Object(s.jsxs)("div",{className:"alert-container",children:[Object(s.jsx)("header",{className:"alert-header",children:Object(s.jsx)("h2",{className:"alert-title",children:t})}),Object(s.jsx)("main",{className:"alert-main",children:Object(s.jsxs)("p",{className:"alert-message",children:[" ",n]})}),Object(s.jsxs)("footer",{className:"alert-footer",children:[Object(s.jsx)("button",{name:"confirm",onClick:a,className:"button-outline confirm",children:"Confirm"}),Object(s.jsx)("button",{name:"cancel",onClick:a,className:"button-filled cancel",children:"Cancel"})]})]})})}),W=function(e){var t=e.post,n=e.link,a=e.handleRemove,c=Object(r.useState)(t.score),o=Object(p.a)(c,2),u=o[0],d=o[1],b=Object(r.useState)(!1),h=Object(p.a)(b,2),f=h[0],g=h[1],w=C(),y=N(),k=T(),S=Object(l.g)(),_=function(){g(!f)},P=function(){var e=Object(m.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(v,"/api/s/").concat(t.sub._id,"/posts/").concat(t._id,"/delete"),e.next=3,x(n,y.token);case 3:e.sent.ok?(w.changeMessage("Post deleted successfully!"),a?a(t._id):S.push("/")):console.log("Not Okay.");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(e,t){d((function(e){return e+t})),E("up"===e||"down"!==e&&null)},E=function(){var e=Object(m.a)(j.a.mark((function e(n){var s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(v,"/api/s/").concat(t.sub._id,"/posts/").concat(t._id,"/vote"),e.next=3,O(s,{value:n},y.token);case 3:r=e.sent,console.log(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"post-container",children:[k.width>800?Object(s.jsx)(J,{score:u,item:t,type:"post",handleChoice:D}):null,Object(s.jsxs)("article",{children:[Object(s.jsxs)("header",{className:"card-header",children:[Object(s.jsx)(i.b,{to:"/s/".concat(t.sub._id),className:"header-item sub-link",children:t.sub.name}),Object(s.jsx)("span",{className:"header-item",children:"Posted by"}),t.author?Object(s.jsx)(i.b,{to:"/users/".concat(t.author.username),className:"header-item profile-link",children:t.author.username}):"[Deleted]",Object(s.jsx)("span",{className:"header-item",children:V()(t.dateCreated).startOf("hour").fromNow()}),t.dateEdited?Object(s.jsxs)("span",{className:"header-item edited-item",children:["edited ",V()(t.dateEdited).startOf("hour").fromNow()]}):null]}),Object(s.jsxs)("main",{className:"card-main",children:[Object(s.jsx)("h2",{className:"post-title",children:t.title}),"video"===t.type?Object(s.jsx)("iframe",{title:t.title,className:"post-content-video",src:"https://www.youtube.com/embed/".concat(function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return!(!t||11!==t[7].length)&&t[7]}(t.content)),frameBorder:"0"}):"link"===t.type?Object(s.jsxs)("div",{children:[" ",Object(s.jsx)("a",{className:"post-content-link",href:t.content,children:t.content})]}):"image"===t.type?Object(s.jsx)("img",{className:"post-image",alt:"Post Image",src:t.content}):Object(s.jsx)("p",{className:"post-content",children:t.content})]}),Object(s.jsxs)("footer",{className:"card-footer",children:[k.width<800?Object(s.jsx)(J,{score:u,item:t,type:"post",handleChoice:D}):null,Object(s.jsxs)("span",{className:"footer-item footer-reply",children:[Object(s.jsx)(F.a,{className:"reply-bubble"}),1===t.commentCount?"1 Comment":t.commentCount+" Comments"]}),y.user&&y.user._id===t.author._id?Object(s.jsx)(i.b,{to:"/s/".concat(t.sub._id,"/posts/").concat(t._id,"/update"),className:"footer-item",children:"Edit"}):null,y.user&&y.user._id===t.author._id?Object(s.jsx)("button",{className:"footer-item",name:"delete",onClick:_,children:"Delete"}):null]})]}),n?Object(s.jsx)(i.b,{to:"/s/".concat(t.sub._id,"/posts/").concat(t._id),className:"post-link"}):null]}),f?Object(s.jsx)(z,{title:"Delete Post",message:"Are you sure you want to delete this post?",onSubmit:function(e){e?P():_()}}):null]})},H=(n(200),n(177)),Z=n.n(H),$=(n(304),function(e){var t=e.heading,n=e.color,r=e.children,a=e.footing;return Object(s.jsxs)("div",{className:"sidebar-item",children:[Object(s.jsx)("header",{className:"sidebar-item-header",style:n?{backgroundColor:n}:null,children:Object(s.jsx)("h2",{className:"heading-white",children:t})}),Object(s.jsx)("main",{className:"sidebar-item-main",children:r}),a?Object(s.jsx)("footer",{className:"sidebar-item-footer",children:a}):null]})}),G=function(e){var t=e.sub,n=e.user,a=e.score,c=N(),o=T(),l=Object(r.useState)(null),u=Object(p.a)(l,2),d=u[0],b=u[1];function f(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[n],e[n]=s}}Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("".concat(v,"/api/s/"));case 2:f((t=e.sent).subs),b(t.subs.slice(0,5));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var O=function(){var e=Z.a.MD5(n.email.toLowerCase());return"https://www.gravatar.com/avatar/".concat(e,"?s=200&r=pg&d=mp")};return o.width>950?n?Object(s.jsxs)("div",{id:"sidebar-container",children:[Object(s.jsxs)($,{heading:Object(s.jsx)("img",{className:"profile-picture",src:O()}),children:[Object(s.jsx)("h2",{children:n.username}),Object(s.jsxs)("div",{className:"user-stats",children:[Object(s.jsxs)("div",{className:"user-stat-group",children:[Object(s.jsx)("h5",{className:"user-stat-label",children:"Score"}),Object(s.jsx)("span",{className:"user-stat",children:a})]}),Object(s.jsxs)("div",{className:"user-stat-group",children:[Object(s.jsx)("h5",{className:"user-stat-label",children:"Date Joined"}),Object(s.jsx)("span",{className:"user-stat",children:V()(n.dateJoined).format("MMMM DD YYYY")})]})]})]}),c.user&&c.user._id===n._id?Object(s.jsx)($,{heading:"Edit User Details",children:Object(s.jsxs)("div",{className:"button-box",children:[Object(s.jsx)(i.b,{to:"/users/".concat(c.user.username,"/update_email"),className:"button-filled",children:"Change Email"}),Object(s.jsx)(i.b,{to:"/users/".concat(c.user.username,"/update_password"),className:"button-outline",children:"Change Password"})]})}):null]}):Object(s.jsxs)("div",{id:"sidebar-container",children:[Object(s.jsx)($,{color:t?t.color:null,heading:"About Community",footing:t.dateCreated?"Created: "+V()(t.dateCreated).format("MMMM Do YYYY"):null,children:Object(s.jsx)("p",{children:t.description})}),c.user?Object(s.jsx)($,{heading:"Create Content",color:t?t.color:null,children:Object(s.jsxs)("div",{className:"button-box",children:[Object(s.jsx)(i.b,{to:{pathname:"/submit",state:{subID:t._id}},className:"button-filled",children:"Create Post"}),Object(s.jsx)(i.b,{to:"/s/create",className:"button-outline",children:"Create Community"})]})}):null,Object(s.jsx)($,{color:t?t.color:null,heading:"Other Communities",footing:Object(s.jsx)("div",{className:"button-box",children:Object(s.jsx)(i.b,{className:"button-filled",to:"/s/browse",children:"All Communities"})}),children:d?d.map((function(e){return Object(s.jsxs)("div",{className:"sub-preview",children:[Object(s.jsx)("div",{className:"small-sub-image sub-image"}),e.name,Object(s.jsx)(i.b,{to:"/s/".concat(e._id),className:"sub-preview-link"},e._id)]},e._id)})):null})]}):null},K=(n(305),function(){return Object(s.jsxs)("div",{className:"lds-facebook",children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{})]})}),Q=n(441),X=function(){var e=N(),t=Object(r.useState)(null),n=Object(p.a)(t,2),a=n[0],c=n[1];Object(r.useEffect)((function(){var t=function(){var t=Object(m.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("".concat(v,"/api/s/user/posts/home"),e.token);case 3:n=t.sent,c(n.posts),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n=function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(v,"/api/s/home/posts/"));case 3:t=e.sent,c(t.posts),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e.user?t():n()}),[e.user,e.token]);var o=function(e){var t=a.filter((function(t){return t._id!==e}));c(t)};return Object(s.jsx)("div",{className:"sub-container",children:a?Object(s.jsxs)("main",{className:"sub-page",children:[Object(s.jsx)("div",{className:"posts-container",children:a.length>0?a.map((function(e){return Object(s.jsx)(W,{post:e,link:!0,handleRemove:o},e._id)})):Object(s.jsxs)("div",{className:"empty-sub",children:[Object(s.jsx)("h1",{children:"Subscribe to communities to get started"}),Object(s.jsx)(Q.a,{className:"empty-sub-icon"}),Object(s.jsx)(i.b,{to:"/s/browse",className:"button-filled",children:"Browse Communities"})]})}),Object(s.jsx)(G,{sub:e.user?{name:"Homepage",description:"Your personalized homepage"}:{name:"All",description:"All the newest posts from every community"}})]}):Object(s.jsx)(K,{})})},ee=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(v,"/api/s/home/posts/"));case 3:t=e.sent,a(t.posts),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(s.jsx)("div",{className:"sub-container",children:n?Object(s.jsxs)("main",{className:"sub-page",children:[Object(s.jsx)("div",{className:"posts-container",children:n.map((function(e){return Object(s.jsx)(W,{post:e,link:!0},e._id)}))}),Object(s.jsx)(G,{sub:{name:"All",description:"This is a collection of all the communities newest posts"}})]}):Object(s.jsx)(K,{})})},te=(n(306),n(307),n(308),function(e){var t=e.subData,n=N(),a=C(),c=Object(r.useState)(null),o=Object(p.a)(c,2),i=o[0],l=o[1];Object(r.useEffect)((function(){n.user.subscriptions.some((function(e){return e===t._id}))&&l(!0)}),[t,n.user]);var u=function(){var e=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("".concat(v,"/api/s/").concat(t._id,"/subscribe"),{body:""},n.token);case 3:e.sent.ok?(a.changeMessage("Now subscribed to ".concat(t.name)),n.subscribe(t._id)):console.log("something went wrong"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("".concat(v,"/api/s/").concat(t._id,"/unsubscribe"),{body:""},n.token);case 3:e.sent.ok?(a.changeMessage("Unsubscribed from ".concat(t.name)),n.unsubscribe(t._id)):console.log("something went wrong"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=6;break}return l(!1),e.next=4,d();case 4:e.next=9;break;case 6:return l(!0),e.next=9,u();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsx)("div",{className:"subscribe-button-container",children:Object(s.jsx)("button",{onClick:function(){b()},onMouseOver:function(e){e.target.textContent=i?"Leave":"Join?"},onMouseLeave:function(e){e.target.textContent=i?"Joined":"Join"},className:i?"button-outline subscribe-button":"button-filled subscribe-button",children:i?"Joined":"Join"})})}),ne=n(442),se=function(e){var t=e.subData,n=N();return Object(s.jsxs)("header",{className:"sub-header-container",children:[Object(s.jsx)("div",{className:"community-theme",style:t.color?{backgroundColor:t.color}:null}),Object(s.jsx)("div",{className:"lower-header-container",children:Object(s.jsxs)("div",{className:"header-main-container",children:[Object(s.jsx)("div",{className:"sub-image"}),Object(s.jsxs)("div",{className:"header-sub-container",children:[Object(s.jsx)("div",{className:"sub-title-container",children:Object(s.jsx)("h1",{className:"sub-title",children:t.name})}),Object(s.jsxs)("div",{className:"sub-header-buttons",children:[n.user?Object(s.jsx)(te,{subData:t}):null,n.user&&t.creator===n.user._id?Object(s.jsx)(i.b,{to:"/s/".concat(t._id,"/update"),className:"button-filled nav-button",children:Object(s.jsx)(ne.a,{className:"button-icon"})}):null]})]})]})})]})},re=function(){var e=Object(l.i)().subID,t=Object(r.useState)(null),n=Object(p.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),u=Object(p.a)(o,2),b=u[0],f=u[1];Object(r.useEffect)((function(){(function(){var t=Object(m.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f(!0),t.next=3,h("".concat(v,"/api/s/").concat(e));case 3:n=t.sent,c({sub:n.sub,posts:n.posts}),f(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);var O=function(e){var t=a.posts.filter((function(t){return t._id!==e}));c(Object(d.a)(Object(d.a)({},a),{},{posts:t}))};return b?Object(s.jsx)(K,{}):a?Object(s.jsxs)("div",{className:"sub-container",children:[Object(s.jsx)(se,{subData:a.sub}),Object(s.jsxs)("main",{className:"sub-page",children:[Object(s.jsx)("div",{className:"posts-container",children:a.posts.length>0?a.posts.map((function(e){return Object(s.jsx)(W,{post:e,link:"true",handleRemove:O},e._id)})):Object(s.jsxs)("div",{className:"empty-sub",children:[Object(s.jsx)("h1",{children:"No Posts Yet!"}),Object(s.jsx)(Q.a,{className:"empty-sub-icon"}),Object(s.jsx)(i.b,{to:{pathname:"/submit",state:{subID:a.sub._id}},className:"button-filled",children:"Create Post"})]})}),Object(s.jsx)(G,{sub:a.sub})]})]}):null},ae=(n(309),n(20)),ce=n(21),oe=n(6),ie=n(74),le=(n(103),a.a.forwardRef((function(e,t){var n=e.name,r=e.label,a=e.error,c=Object(ie.a)(e,["name","label","error"]);return Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{className:"form-group-label",htmlFor:n,children:r}),Object(s.jsx)("input",Object(d.a)(Object(d.a)({className:a?"form-group-input-error":"form-group-input",name:n},c),{},{ref:t})),a?Object(s.jsx)("span",{className:"error",children:a}):null]})}))),ue=(n(408),function(e){var t=e.handleSubmit,n=e.title,r=e.error,a=e.art,c=e.button,o=e.children;return Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsx)("div",{className:"form-art art".concat(a)}),Object(s.jsxs)("form",{className:"formy-form",onSubmit:t,children:[Object(s.jsx)("h2",{className:"form-heading",children:n}),r?Object(s.jsx)("div",{className:"error-block",children:r}):null,o,Object(s.jsx)("input",{type:"submit",className:"button-filled",value:c})]})]})}),de=a.a.forwardRef((function(e,t){var n=e.name,r=e.label,a=e.placeholder,c=e.error;return Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{className:"form-group-label",htmlFor:n,children:r}),Object(s.jsx)("textarea",{className:c?"form-group-textarea-error":"form-group-textarea",name:n,placeholder:a,ref:t}),c?Object(s.jsx)("span",{className:"error",children:c}):null]})})),be=a.a.forwardRef((function(e,t){var n=e.name,r=e.label,a=e.defaultValue,c=e.optionsArray,o=e.error;return Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:n,className:"form-group-label",children:r}),Object(s.jsx)("select",{name:n,defaultValue:a,ref:t,children:c.map((function(e){return Object(s.jsx)("option",{value:e._id,children:e.name},e._id)}))}),o?Object(s.jsx)("span",{className:"error",children:o}):null]})})),je=function(e){var t=e.edit,n=Object(l.h)();console.log(n);var a=N(),c=C(),o=Object(l.g)(),i=Object(l.i)()||"",u=i.subID,d=i.postID,b=Object(r.useState)("text"),x=Object(p.a)(b,2),g=x[0],w=x[1],y=Object(r.useState)(null),k=Object(p.a)(y,2),S=k[0],_=k[1],P=Object(r.useState)(null),D=Object(p.a)(P,2),E=D[0],M=D[1];Object(r.useEffect)((function(){}),[g]);var q=Object(ae.useForm)({resolver:Object(ce.yupResolver)("text"===g?oe.a().shape({title:oe.c().required("Title is required").min(3).max(300).trim(),content:oe.c().max(2e3).trim()}):"image"===g?oe.a().shape({title:oe.c().required("Title is required").min(3).max(300).trim(),image:oe.c().url("Something doesn't look right").required("Valid URL is required").max(100).min(1).trim()}):"video"===g?oe.a().shape({title:oe.c().required("Title is required").min(3).max(300).trim(),video:oe.c().url("Something doesn't look right").required("A link is required").matches(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,{message:"Must be a valid YouTube URL"}).max(100).min(1).trim()}):oe.a().shape({title:oe.c().required("Title is required").min(3).max(300).trim(),link:oe.c().url("Something doesn't look right").required("Valid URL is required").max(100).min(1).trim()})),shouldUnregister:!1}),I=q.register,A=q.handleSubmit,L=q.errors,R=q.setValue;Object(r.useEffect)((function(){t||function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("".concat(v,"/api/s/user"),a.token);case 2:t=e.sent,_(t.subs);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[a.token,t]),Object(r.useEffect)((function(){t&&function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("".concat(v,"/api/s/").concat(u,"/posts/").concat(d));case 2:t=e.sent,console.log(t),t.post.type&&w(t.post.type),t.post.type&&"video"===t.post.type&&R(t.post.type,t.post.content,{shouldValidate:!0}),R("title",t.post.title,{shouldValidate:!0});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,d,R,u]);var F=function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("".concat(v,"/api/s/").concat(u,"/posts/create"),t,a.token);case 2:(n=e.sent).post?(c.changeMessage(n.message),o.push("/s/".concat(t.sub,"/posts/").concat(n.post._id))):M("Something went wrong");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(v,"/api/s/").concat(u,"/posts/").concat(d,"/update"),e.next=4,O(n,t,a.token);case 4:e.sent.ok?(c.changeMessage("Post updated successfully"),o.push("/s/".concat(t.sub,"/posts/").concat(d))):M("Something went wrong"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log({message:"something went wrong",error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),U=function(e){w(e.target.name)};return Object(s.jsxs)(ue,{handleSubmit:A((function(e){var n=e,s=n.title,r=n.sub,a=n.content,c=n.video,o=n.link,i=n.image;e="video"===g?{title:s,content:c,type:g,sub:r}:"image"===g?{title:s,sub:r,type:g,content:i}:"link"===g?{title:s,sub:r,type:g,content:o}:{title:s,sub:r,type:g,content:a},t?T(e):F(e)})),title:t?"Edit Post":"Create Post",error:E,art:"1",button:t?"Save Changes":"Create Post",children:[Object(s.jsxs)("div",{className:"type-selector",children:[Object(s.jsx)("button",{type:"button",name:"text",onClick:U,className:"text"===g?"type-selection selected":"type-selection",children:"Text"}),Object(s.jsxs)("button",{type:"button",name:"image",onClick:U,className:"image"===g?"type-selection selected":"type-selection",children:[" ","Image"]}),Object(s.jsx)("button",{type:"button",name:"video",onClick:U,className:"video"===g?"type-selection selected":"type-selection",children:"Video"}),Object(s.jsx)("button",{type:"button",name:"link",onClick:U,className:"link"===g?"type-selection selected":"type-selection",children:"Link"})]}),S?Object(s.jsx)(be,{name:"sub",label:"Community",defaultValue:n.state?n.state.subID:null,optionsArray:S,ref:I,error:L.sub?L.sub.message:null}):null,Object(s.jsx)(le,{name:"title",type:"text",label:"Title",placeholder:"What did you want everyone to know about?",ref:I,error:L.title?L.title.message:null}),"text"===g?Object(s.jsx)(de,{name:"content",label:"Content",placeholder:"optional",ref:I,error:L.content?L.content.message:null}):"video"===g?Object(s.jsx)(le,{name:"video",type:"text",label:"YouTube Video",placeholder:"Please include the full url",ref:I,error:L.video?L.video.message:null}):"link"===g?Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{className:"form-group-label",htmlFor:"link",children:"Link"}),Object(s.jsx)("input",{className:L.link?"form-group-input-error":"form-group-input",name:"link",type:"text",placeholder:"Please include the full url",ref:I}),L.link?Object(s.jsx)("span",{className:"error",children:L.link.message}):null]}):Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{className:"form-group-label",htmlFor:"image",children:"Image Link"}),Object(s.jsx)("input",{className:L.image?"form-group-input-error":"form-group-input",name:"image",type:"text",placeholder:"Please include the full url",ref:I}),L.image?Object(s.jsx)("span",{className:"error",children:L.image.message}):null]})]})},me=function(e){var t=e.edit,n=(Object(l.i)()||"").subID,a=N(),c=C(),o=Object(l.g)(),i=Object(r.useState)(null),u=Object(p.a)(i,2),d=u[0],b=u[1],x=Object(ae.useForm)({resolver:Object(ce.yupResolver)(t?oe.a().shape({description:oe.c().required().min(6).max(600)}):oe.a().shape({name:oe.c().required().min(3).max(20).trim().matches(/^[_a-zA-Z0-9]*$/,{message:"cannot contain special characters or spaces"}),description:oe.c().required().min(6).max(600)}))}),g=x.register,w=x.handleSubmit,y=x.setValue,k=x.errors;Object(r.useEffect)((function(){t&&function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("".concat(v,"/api/s/").concat(n,"\n      "));case 2:t=e.sent,y("name",t.sub.name),y("description",t.sub.description),y("color",t.sub.color);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,y,n]);var S=function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat(v,"/api/s/create"),t,a.token);case 3:(n=e.sent).errors?b(n.errors[0].msg):n.sub&&c.changeMessage("New community created!"),o.push("/s/".concat(n.sub._id)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),b(e.t0),console.log("something wrong in sub creation");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("".concat(v,"/api/s/").concat(n,"/update"),t,a.token);case 3:e.sent.ok?o.push("/s/".concat(n)):console.log("errorsss"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),b(e.t0),console.log("something wrong in sub creation");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(ue,{handleSubmit:w((function(e){t?_(e):S(e)})),title:t?"Update Community":"Create Community",error:d,art:"1",button:t?"Save Changes":"Create Community",children:[Object(s.jsx)(le,{name:"name",label:"Community Name",type:"text",placeholder:"3-20 characters",disabled:t?"disabled":null,ref:g,error:k.name?k.name.message:null}),Object(s.jsx)(de,{name:"description",label:"Description",placeholder:"min 6 characters",ref:g,error:k.description?k.description.message:null}),Object(s.jsx)(le,{name:"color",label:"Community Color",type:"color",ref:g})]})},pe=(n(417),n(418),n(419),oe.a().shape({content:oe.c().required().min(1).max(600)})),he=function(e){var t=N(),n=C(),a=e.parentComment,c=e.refreshPost,o=e.handleForm,u=e.edit,d=Object(l.i)(),b=d.subID,p=d.postID,h=a?a._id:null,x=Object(ae.useForm)({resolver:Object(ce.yupResolver)(pe)}),g=x.register,w=x.handleSubmit,y=x.errors,k=x.setValue;Object(r.useEffect)((function(){u&&k("content",a.content,{shouldValidate:!0})}),[a,u,k]);var S=function(){var e=Object(m.a)(j.a.mark((function e(s){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a?console.log(!0):console.log(!1),e.next=4,f("".concat(v,"/api/s/").concat(b,"/posts/").concat(p,"/comments/create"),a?{content:s,parent:a._id}:{content:s},t.token);case 4:e.sent.comment&&(n.changeMessage("Comment created successfully"),c()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(m.a)(j.a.mark((function e(s){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="".concat(v,"/api/s/").concat(b,"/posts/").concat(p,"/comments/").concat(h,"/update"),e.next=4,O(r,{content:s},t.token);case 4:e.sent.ok?(n.changeMessage("Comment edited successfully"),c()):n.changeMessage("Oops! Something went wrong."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return t.user?Object(s.jsxs)("form",{className:"comment-form",onSubmit:w((function(e){var t=e.content;u?_(t):S(t)})),children:[Object(s.jsx)(de,{name:"content",placeholder:"What are your thoughts?",ref:g,error:y.content?y.content.message:null}),Object(s.jsxs)("div",{className:"form-button-container",children:[a?Object(s.jsx)("button",{className:"button-outline",id:"cancel-form",onClick:function(e){e.preventDefault(),o(e)},children:"Cancel"}):null,Object(s.jsx)("button",{className:"button-filled",onClick:w,children:u?"Edit":"Comment"})]})]}):Object(s.jsxs)("div",{className:"no-user-box",children:[Object(s.jsx)("span",{children:"Log in or sign up to leave a comment"}),Object(s.jsxs)("div",{className:"nav-buttons",children:[Object(s.jsx)(i.b,{to:"/signup",className:"button-outline nav-button",children:"Sign Up"}),Object(s.jsx)(i.b,{to:"/login",className:"button-filled nav-button",children:"Log In"})]})]})},fe=(n(420),function(e){var t=e.comment,n=e.post,a=e.refreshPost,c=e.layer,o=e.handleRemove,l=e.children,u=C(),d=N(),b=Object(r.useState)(!1),h=Object(p.a)(b,2),f=h[0],g=h[1],w=Object(r.useState)(!1),y=Object(p.a)(w,2),k=y[0],S=y[1],_=Object(r.useState)(t.score),P=Object(p.a)(_,2),D=P[0],E=P[1],M=Object(r.useState)(!1),q=Object(p.a)(M,2),I=q[0],A=q[1],L=function(e){"delete"===e.target.name?T():("edit"===e.target.name&&S(!0),f?(g(!1),S(!1)):g(!0))},R=function(){var e=Object(m.a)(j.a.mark((function e(){var s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(v,"/api/s/").concat(n?n.sub._id:t.post.sub,"/posts/").concat(n?n._id:t.post._id,"/comments/").concat(t._id,"/delete"),e.next=3,x(s,d.token);case 3:r=e.sent,console.log(r),r.ok?(o?o(t._id):a(),u.changeMessage("Comment Deleted")):u.changeMessage("Oops! Something went wrong!");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){A(!I)},U=function(){var e=Object(m.a)(j.a.mark((function e(s){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(v,"/api/s/").concat(n.sub._id,"/posts/").concat(n._id,"/comments/").concat(t._id,"/vote"),e.next=3,O(r,{value:s},d.token);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:t.parent?"comment-reply":"comment-container",children:[I?Object(s.jsx)(z,{title:"Delete Comment",message:"Are you sure you want to delete this comment?",onSubmit:function(e){e?R():T()}}):null,Object(s.jsxs)("div",{className:"comment",children:[t.author?Object(s.jsx)(J,{score:D,item:t,type:"comment",handleChoice:function(e,t){E((function(e){return e+t})),U("up"===e||"down"!==e&&null)}}):null,Object(s.jsxs)("article",{children:[Object(s.jsxs)("header",{className:"card-header",children:[t.author?Object(s.jsx)(i.b,{className:"header-item profile-link",to:"/users/".concat(t.author.username),children:t.author.username}):Object(s.jsx)("span",{className:"header-item",children:"[deleted]"}),Object(s.jsx)("span",{className:"header-item",children:1===D?D+" point":D+" points"}),Object(s.jsxs)("span",{className:"header-item",children:["- ",V()(t.dateCreated).startOf("hour").fromNow()]}),t.dateEdited?Object(s.jsxs)("span",{className:"header-item edited-item",children:["edited ",V()(t.dateEdited).startOf("hour").fromNow()]}):null]}),Object(s.jsx)("main",{className:"card-main",children:Object(s.jsx)("span",{children:t.content?t.content:"[deleted]"})}),d.user&&t.author?Object(s.jsxs)("footer",{className:"card-footer",children:[c<6?Object(s.jsxs)("button",{onClick:L,className:"footer-item",children:[Object(s.jsx)(F.a,{className:"reply-bubble"}),"Reply"]}):null,d.user&&d.user._id===t.author._id?Object(s.jsxs)("div",{className:"footer-button-container",children:[Object(s.jsx)("button",{className:"footer-item",name:"edit",onClick:L,children:"Edit"}),Object(s.jsx)("button",{className:"footer-item",name:"delete",onClick:L,children:"Delete"})]}):null]}):null,f?Object(s.jsx)(he,{post:n,parentComment:t,refreshPost:a,handleForm:L,edit:k}):null]})]}),l]})}),Oe=function(e){var t=e.comments,n=e.post,r=e.refreshPost;return Object(s.jsxs)("div",{id:"comments-container",children:[Object(s.jsx)("h3",{children:"Leave A Comment"}),Object(s.jsx)("div",{children:Object(s.jsx)(he,{post:n,refreshPost:r})}),Object(s.jsx)("div",{id:"comments-index",children:t?function e(t,a){return t.map((function(t){return Object(s.jsx)(fe,{comment:t,post:n,refreshPost:r,layer:a,children:t.replies?e(t.replies,a+1):null},t._id)}))}(t,1):null})]})},xe=function(){var e=Object(l.i)(),t=e.subID,n=e.postID,a=Object(r.useState)(null),c=Object(p.a)(a,2),o=c[0],i=c[1],u=Object(r.useState)(!1),d=Object(p.a)(u,2),b=d[0],f=d[1];Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,h("".concat(v,"/api/s/").concat(t,"/posts/").concat(n));case 3:s=e.sent,i(s.post),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n,t]);var O=function(){var e=Object(m.a)(j.a.mark((function e(){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,h("".concat(v,"/api/s/").concat(t,"/posts/").concat(n));case 3:s=e.sent,i(s.post),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsx)("div",{children:b?Object(s.jsx)(K,{}):o?Object(s.jsxs)("div",{className:"post-details-container",children:[Object(s.jsxs)("div",{className:"post-details",children:[Object(s.jsx)(W,{post:o}),Object(s.jsx)(Oe,{comments:o.comments,post:o,refreshPost:O})]}),Object(s.jsx)(G,{sub:o.sub})]}):null})},ve=oe.a().shape({username:oe.c().required("A username is required").min(3,"Usernames must be between 3-20 characters in length").max(20,"Usernames must be between 3-20 characters in length").trim().matches(/^[_a-zA-Z0-9]*$/,{message:"cannot contain special characters or spaces"}),password:oe.c().required("Password is required").min(6).max(40),password2:oe.c().required("Please re-enter password").oneOf([oe.b("password"),null],"Passwords must match"),email:oe.c().required("An email is required").email("Must be a valid email")}),ge=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],a=t[1],c=N(),o=C(),i=Object(l.g)(),u=Object(ae.useForm)({resolver:Object(ce.yupResolver)(ve)}),d=u.register,b=u.handleSubmit,h=u.errors,f=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,s,r,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,s=t.password,r=t.email,e.prev=1,e.next=4,c.signup(n,s,r);case 4:(l=e.sent).user?(o.changeMessage("Account created successfully! Please log in."),i.push("/login")):l.errors?(console.log(l),a(l.errors[0].msg)):a("Something went wrong."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(ue,{handleSubmit:b(f),title:"Sign Up",error:n,art:"2",button:"Create Account",children:[Object(s.jsx)(le,{name:"username",label:"Username",type:"text",placeholder:"",ref:d,error:h.username?h.username.message:null}),Object(s.jsx)(le,{name:"email",label:"Email",type:"text",placeholder:"example@example.com",ref:d,error:h.email?h.email.message:null}),Object(s.jsx)(le,{name:"password",label:"Password",type:"password",placeholder:"",ref:d,error:h.password?h.password.message:null}),Object(s.jsx)(le,{name:"password2",label:"Confirm Password",type:"password",placeholder:"",ref:d,error:h.password2?h.password2.message:null})]})},we=oe.a().shape({username:oe.c().required().min(3).max(20).trim(),password:oe.c().required().min(6).max(40).trim()}),Ne=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],a=t[1],c=Object(l.g)(),o=(Object(l.h)().state||{from:{pathname:"/"}}).from,i=N(),u=C(),d=Object(ae.useForm)({resolver:Object(ce.yupResolver)(we)}),b=d.register,h=d.handleSubmit,f=d.errors,O=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,s=t.password,e.next=3,i.login(n,s);case 3:(r=e.sent).user||a(r.message),r.user&&(c.replace(o),u.changeMessage("Welcome back ".concat(r.user.username)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(ue,{handleSubmit:h(O),title:"Log In",error:n,art:"2",button:"Log In",children:[Object(s.jsx)(le,{name:"username",label:"Username",type:"text",placeholder:"",ref:b,error:f.username?f.username.message:null}),Object(s.jsx)(le,{name:"password",label:"Password",type:"password",ref:b,error:f.password?f.password.message:null})]})},ye=(n(421),function(){var e=T(),t=(Object(l.i)()||"").username,n=Object(r.useState)("posts"),a=Object(p.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(null),u=Object(p.a)(i,2),b=u[0],f=u[1];Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(v,"/api/users/").concat(t));case 3:n=e.sent,f(n.user),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);var O=function(e){"posts"===e.target.name?o("posts"):o("comments")},x=function(e){var t=b.posts.filter((function(t){return t._id!==e}));f(Object(d.a)(Object(d.a)({},b),{},{posts:t}))},g=function(e){var t=b.comments.filter((function(t){return t._id!==e}));f(Object(d.a)(Object(d.a)({},b),{},{comments:t}))};return b?Object(s.jsxs)("div",{className:"user-profile-container",children:[Object(s.jsxs)("nav",{className:"profile-nav",children:[Object(s.jsxs)("button",{onClick:O,name:"posts",className:"type-selection",style:"posts"===c?{borderBottom:"2px solid #222"}:null,children:["Posts (",b.posts.length,")"]}),Object(s.jsxs)("button",{onClick:O,name:"comments",className:"type-selection",style:"comments"===c?{borderBottom:"2px solid #222"}:null,children:["Comments (",b.comments.length,")"]})]}),Object(s.jsx)("div",{className:"user-profile-content",children:"posts"===c?b.posts.map((function(e){return Object(s.jsx)(W,{post:e,link:"true",handleRemove:x},e._id)})):b.comments.map((function(e){return Object(s.jsxs)("div",{className:"comment-box",children:[Object(s.jsx)("div",{children:e.post?Object(s.jsxs)("span",{children:[e.post.title," posted by ",e.post.author.username]}):Object(s.jsx)("span",{children:"deleted"})}),Object(s.jsx)(fe,{comment:e,handleRemove:g})]},e._id)}))}),e.width>800?Object(s.jsx)("div",{className:"user-details",children:Object(s.jsx)(G,{user:b,score:function(){var e=0;return b.posts.forEach((function(t){return e+=t.score})),b.comments.forEach((function(t){return e+=t.score})),e}()})}):null]}):Object(s.jsx)(K,{})}),ke=(n(422),function(){var e=N(),t=Object(r.useState)(null),n=Object(p.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),l=Object(p.a)(o,2),u=l[0],d=l[1];return Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,h("".concat(v,"/api/s/"));case 3:t=e.sent,c(t.subs),d(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(s.jsxs)("div",{id:"sub-index-container",children:[Object(s.jsxs)("header",{id:"sub-index-header",children:[Object(s.jsx)("h3",{className:"white-heading",children:"Browse Communities"}),Object(s.jsx)(i.b,{to:"create",className:"button-outline nav-button",children:"Create Community"})]}),Object(s.jsx)("div",{id:"sub-index",children:u?Object(s.jsx)(K,{}):a?a.map((function(t){return Object(s.jsxs)("div",{className:"sub-preview-large",children:[Object(s.jsxs)("div",{className:"preview-name-box",children:[" ",Object(s.jsx)("div",{className:"sub-circle",style:t.color?{backgroundColor:t.color}:null}),Object(s.jsx)("span",{className:"sub-name preview-item",children:t.name})]}),e.user?Object(s.jsx)(te,{subData:t}):null,Object(s.jsx)(i.b,{to:"".concat(t._id),className:"sub-preview-link"},t._id)]})})):null})]})}),Ce=(n(423),oe.a().shape({oldPassword:oe.c().required("Please enter your old password").min(6).max(40),password:oe.c().required("New password is required").min(6).max(40),password2:oe.c().required("Please re-enter password").oneOf([oe.b("password"),null],"Passwords must match")})),Se=oe.a().shape({email:oe.c().required("An email is required").email("Must be a valid email")}),_e=function(e){var t=e.email,n=Object(r.useState)(null),a=Object(p.a)(n,2),c=a[0],o=a[1],i=N(),u=C(),d=Object(l.g)(),b=Object(ae.useForm)({resolver:t?Object(ce.yupResolver)(Se):Object(ce.yupResolver)(Ce)}),h=b.register,f=b.handleSubmit,x=b.errors,g=function(e){console.log(e),t?y(e):w(e)},w=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,s,r,a,c,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.oldPassword,s=t.password,r=t.password2,a="".concat(v,"/api/users/").concat(i.user.username,"/update_password"),e.prev=2,e.next=5,O(a,{oldPassword:n,password:s,password2:r},i.token);case 5:if(!(c=e.sent).ok){e.next=11;break}u.changeMessage("Password successfully updated"),d.push("/users/".concat(i.user.username)),e.next=16;break;case 11:return e.next=13,c.json();case 13:(l=e.sent).errors&&o(l.errors[0].msg),console.log({response:c,data:l});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,s,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,s="".concat(v,"/api/users/").concat(i.user.username,"/update_email"),e.prev=2,e.next=5,O(s,{email:n},i.token);case 5:if(!(r=e.sent).ok){e.next=11;break}u.changeMessage("Email successfully updated"),d.push("/users/".concat(i.user.username)),e.next=16;break;case 11:return e.next=13,r.json();case 13:(a=e.sent).errors&&o(a.errors[0].msg),console.log(r);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}();return t?Object(s.jsx)(ue,{handleSubmit:f(g),title:"Change Email Address",error:c,art:"2",button:"Update Email",children:Object(s.jsx)(le,{name:"email",label:"New Email",type:"text",placeholder:"example@example.com",ref:h,error:x.email?x.email.message:null})}):Object(s.jsxs)(ue,{handleSubmit:f(g),title:"Change Password",error:c,art:"2",button:"Update Password",children:[Object(s.jsx)(le,{name:"oldPassword",label:"Old Password",type:"text",placeholder:"",ref:h,error:x.oldPassword?x.oldPassword.message:null}),Object(s.jsx)(le,{name:"password",label:"New Password",type:"password",placeholder:"",ref:h,error:x.password?x.password.message:null}),Object(s.jsx)(le,{name:"password2",label:"Confirm Password",type:"password",placeholder:"",ref:h,error:x.password2?x.password2.message:null})]})},Pe=(n(424),function(){var e=C();return e.showMessage?Object(s.jsxs)("div",{className:"flash-container",children:[Object(s.jsx)("aside",{className:"blue-bar"}),Object(s.jsx)("span",{className:"flash-message",children:e.message})]}):null}),De=function(e){var t=e.children,n=Object(ie.a)(e,["children"]),r=N();return Object(s.jsx)(l.b,Object(d.a)(Object(d.a)({},n),{},{render:function(e){var n=e.location;return r.user?t:Object(s.jsx)(l.a,{to:{pathname:"/login",state:{from:n}}})}}))};var Ee=function(){return Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(w,{children:Object(s.jsxs)(k,{children:[Object(s.jsx)(Pe,{}),Object(s.jsxs)(i.a,{children:[Object(s.jsx)(R,{}),Object(s.jsx)("main",{id:"main-container",children:Object(s.jsxs)(l.d,{children:[Object(s.jsx)(De,{path:"/users/:username/update_email",children:Object(s.jsx)(_e,{email:!0})}),Object(s.jsx)(De,{path:"/users/:username/update_password",children:Object(s.jsx)(_e,{})}),Object(s.jsx)(l.b,{path:"/users/:username",children:Object(s.jsx)(ye,{})}),Object(s.jsx)(De,{path:"/s/:subID/update",children:Object(s.jsx)(me,{edit:!0})}),Object(s.jsx)(De,{path:"/s/:subID/posts/:postID/update",children:Object(s.jsx)(je,{edit:!0})}),Object(s.jsx)(l.b,{path:"/s/:subID/posts/:postID",children:Object(s.jsx)(xe,{})}),Object(s.jsx)(De,{path:"/s/:subID/submit",children:Object(s.jsx)(je,{})}),Object(s.jsx)(De,{path:"/s/create",children:Object(s.jsx)(me,{})}),Object(s.jsx)(l.b,{path:"/s/browse",children:Object(s.jsx)(ke,{})}),Object(s.jsx)(l.b,{path:"/s/all",children:Object(s.jsx)(ee,{})}),Object(s.jsx)(l.b,{path:"/s/:subID",children:Object(s.jsx)(re,{})}),Object(s.jsx)(De,{path:"/submit",children:Object(s.jsx)(je,{})}),Object(s.jsx)(l.b,{path:"/login",children:Object(s.jsx)(Ne,{})}),Object(s.jsx)(l.b,{path:"/signup",children:Object(s.jsx)(ge,{})}),Object(s.jsx)(De,{path:"/home",children:Object(s.jsx)(X,{})}),Object(s.jsx)(l.b,{path:"/",children:Object(s.jsx)(X,{})})]})})]})]})})})},Me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,443)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),s(e),r(e),a(e),c(e)}))};o.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(Ee,{})}),document.getElementById("root")),Me()}},[[425,1,2]]]);
//# sourceMappingURL=main.d0f6b969.chunk.js.map
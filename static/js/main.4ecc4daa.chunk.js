(this["webpackJsonpreddit-clone-frontend"]=this["webpackJsonpreddit-clone-frontend"]||[]).push([[0],{111:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){},128:function(e,t){},153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},156:function(e,t,n){},157:function(e,t,n){},158:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),r=n(95),a=n.n(r),o=n(5),i=n(11),l=(n(111),n(7)),u=n(12),b=n(2),d=n(4),j=n(3),m=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n,s,c,r=arguments;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"",e.prev=1,e.next=4,fetch(t,{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 4:return s=e.sent,e.next=7,s.json();case 7:return c=e.sent,e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t,n,s){var c,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 3:return c=e.sent,e.next=6,c.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,s){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t,n,s){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"put",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 3:return c=e.sent,e.abrupt("return",c);case 7:e.prev=7,e.t0=e.catch(0),console.log({error:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,s){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t,n){var s;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 3:return s=e.sent,e.abrupt("return",s);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),f="https://reddit-api-00tw.onrender.com",x=n(0),v=Object(s.createContext)();function g(e){var t=e.children,n=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(null),a=Object(j.a)(r,2),o=a[0],i=a[1],m=function(e){e.forEach((function(e){var t={};!0!==e.value&&!1!==e.value||(t.id=e.post?e.post:e.comment,t.value=e.value?"up":"down",localStorage.setItem(t.id,t.value))}))},h=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t,n){var s;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p("".concat(f,"/api/users/login"),{username:t,password:n});case 3:if((s=e.sent).user){e.next=8;break}return e.abrupt("return",s);case 8:if(!s.user){e.next=13;break}return m(s.votes),c(s.user),i(s.token),e.abrupt("return",{user:s.user});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t,n,s){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p("".concat(f,"/api/users/create"),{username:t,password:n,email:s});case 3:return c=e.sent,e.abrupt("return",c);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,s){return e.apply(this,arguments)}}(),x=function(){c(null),i(null),localStorage.clear()},v=function(e){c(Object(u.a)(Object(u.a)({},n),{},{subscriptions:[].concat(Object(l.a)(n.subscriptions),[e])}))},g=function(e){var t=n.subscriptions.filter((function(t){return t!==e}));c(Object(u.a)(Object(u.a)({},n),{},{subscriptions:t}))};return Object(s.useEffect)((function(){var e=function(e){c(e||!1)};return function(){return e()}}),[]),{user:n,token:o,login:h,signup:O,logout:x,subscribe:v,unsubscribe:g}}();return Object(x.jsx)(v.Provider,{value:n,children:t})}var w=function(){return Object(s.useContext)(v)};var N=Object(s.createContext)();function k(e){var t=e.children,n=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(!1),a=Object(j.a)(r,2),o=a[0],i=a[1];return{message:n,showMessage:o,changeMessage:function(e){c(e),i(!0),setTimeout((function(){i(!1)}),5e3)}}}();return Object(x.jsx)(N.Provider,{value:n,children:t})}var y=function(){return Object(s.useContext)(N)};n(113),n(114),n(115);var C=function(e){var t=e.data,n=e.children,s=t.onClick,c=t.href,r=t.title;return Object(x.jsxs)(o.b,{to:c,className:"sidenav-item",onClick:s,children:[n,Object(x.jsx)("span",{className:"sidenav-item-heading",children:r})]})},S=n(276),_=n(278),P=n(274),D=n(275),E=n(273),M=n(271),q=n(272),I=n(277),A=function(e){var t=e.logout,n=w(),c=Object(s.useState)(null),r=Object(j.a)(c,2),a=r[0],o=r[1],i=Object(s.useState)(!1),l=Object(j.a)(i,2),u=l[0],p=l[1];Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m("".concat(f,"/api/s/user"),n.token);case 3:t=e.sent,o(t.subs),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();n.token?e():o(null)}),[n.token,u]);var h=function(){p(!u)},O=function(e,t){return{href:e,title:t,onClick:h}};return Object(x.jsxs)("div",{id:"nav-subs",children:[Object(x.jsxs)("button",{id:"sub-nav-button",onClick:h,children:[Object(x.jsx)(M.a,{className:"menu-icon"}),Object(x.jsx)("span",{className:"sidenav-button-text",children:"Menu"})]}),u?Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{id:"sidenav-overlay",onClick:h}),Object(x.jsxs)("div",{id:"sub-sidenav",className:u?"sidenav-show":"sidenav-hide",children:[Object(x.jsxs)("header",{className:"sidenav-profile-header",children:[Object(x.jsx)("h5",{className:"sidenav-username",children:n.user.username}),Object(x.jsx)("button",{className:"close-button",onClick:h,children:Object(x.jsx)(q.a,{className:"close-button-icon"})})]}),Object(x.jsxs)("div",{className:"sidenav-section",children:[Object(x.jsx)(C,{data:O("/users/".concat(n.user.username),"Profile"),children:Object(x.jsx)(E.a,{className:"sidenav-item-icon"})}),Object(x.jsx)(C,{data:O("/","Home"),children:Object(x.jsx)(P.a,{className:"sidenav-item-icon"})}),Object(x.jsx)(C,{data:O("/s/all","All"),children:Object(x.jsx)(D.a,{className:"sidenav-item-icon"})}),Object(x.jsx)(C,{data:O("/s/browse","Browse Communities"),children:Object(x.jsx)(S.a,{className:"sidenav-item-icon"})})]}),Object(x.jsxs)("div",{className:"sidenav-section",children:[Object(x.jsx)("h6",{className:"sidenav-heading",children:"My Communities"}),a.length>0?a.map((function(e){return Object(x.jsx)(C,{data:O("/s/".concat(e._id),e.name),children:Object(x.jsx)("div",{className:"sidenav-item-circle",style:e.color?{backgroundColor:e.color}:null})},e._id)})):null]}),Object(x.jsxs)("div",{className:"sidenav-section",children:[Object(x.jsx)("h6",{className:"sidenav-heading",children:"Other"}),Object(x.jsx)(C,{data:O("/submit","Create Post"),children:Object(x.jsx)(I.a,{className:"sidenav-item-icon"})}),Object(x.jsx)(C,{data:O("/s/create","Create Community"),children:Object(x.jsx)(_.a,{className:"sidenav-item-icon"})})]}),Object(x.jsx)("div",{className:"sidenav-button-box",children:Object(x.jsx)("button",{className:"button-outline logout-button",onClick:t,children:"Logout"})}),Object(x.jsx)("div",{className:"blue-box"})]})]}):null]})},L=function(){var e=w(),t=Object(i.g)();return Object(x.jsx)("div",{id:"nav-container",children:Object(x.jsxs)("nav",{id:"top-nav",children:[Object(x.jsx)(o.b,{to:"/",id:"nav-brand",children:"S/eddit"}),Object(x.jsx)("div",{id:"nav-sub-container",children:e.user?Object(x.jsx)(A,{logout:function(){e.logout(),t.push("/")}}):Object(x.jsxs)("div",{className:"nav-buttons",children:[Object(x.jsx)(o.b,{to:"/signup",className:"button-outline nav-button",children:"Sign Up"}),Object(x.jsx)(o.b,{to:"/login",className:"button-filled nav-button",children:"Log In"})]})})]})})},T=(n(124),n(281));function U(){var e=Object(s.useState)({width:void 0,height:void 0}),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(s.useEffect)((function(){function e(){c({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}var R=n(25),V=n.n(R),B=n(279),Y=n(280),F=(n(125),function(e){var t=e.score,n=e.item,c=e.type,r=e.handleChoice,a=w(),o=Object(s.useState)(a.user?localStorage.getItem(n._id):null),i=Object(j.a)(o,2),l=i[0],u=i[1],b=function(e){var t=e.currentTarget.name;l&&l===t?d(null,"up"===t?-1:1):d(t,l&&l!==t?"up"===t?2:-2:"up"===t?1:-1)},d=function(e,t){u(e),null===e?localStorage.removeItem(n._id):localStorage.setItem(n._id,e),r(e,t)};return Object(x.jsxs)("div",{className:"post"===c?"post-score-box":"score-box",children:[Object(x.jsx)("button",{name:"up",onClick:a.user?b:null,className:"invis-button",children:Object(x.jsx)(B.a,{className:"score-arrow up-arrow",style:"up"===l?{color:"var(--orange)"}:null})}),"post"===c?Object(x.jsx)("span",{className:"score-number",children:t}):null,Object(x.jsx)("button",{name:"down",onClick:a.user?b:null,className:"invis-button",children:Object(x.jsx)(Y.a,{className:"score-arrow down-arrow",style:"down"===l?{color:"var(--blue)"}:null})})]})}),J=(n(126),function(e){var t=e.title,n=e.message,s=e.onSubmit,c=function(e){"confirm"===e.target.name?s(!0):s(!1)};return Object(x.jsx)("div",{className:"alert-overlay",children:Object(x.jsxs)("div",{className:"alert-container",children:[Object(x.jsx)("header",{className:"alert-header",children:Object(x.jsx)("h2",{className:"alert-title",children:t})}),Object(x.jsx)("main",{className:"alert-main",children:Object(x.jsxs)("p",{className:"alert-message",children:[" ",n]})}),Object(x.jsxs)("footer",{className:"alert-footer",children:[Object(x.jsx)("button",{name:"confirm",onClick:c,className:"button-outline confirm",children:"Confirm"}),Object(x.jsx)("button",{name:"cancel",onClick:c,className:"button-filled cancel",children:"Cancel"})]})]})})}),z=function(e){var t=e.post,n=e.link,c=e.handleRemove,r=Object(s.useState)(t.score),a=Object(j.a)(r,2),l=a[0],u=a[1],m=Object(s.useState)(!1),p=Object(j.a)(m,2),v=p[0],g=p[1],N=y(),k=w(),C=U(),S=Object(i.g)(),_=function(){g(!v)},P=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(f,"/api/s/").concat(t.sub._id,"/posts/").concat(t._id,"/delete"),e.next=3,O(n,k.token);case 3:e.sent.ok?(N.changeMessage("Post deleted successfully!"),c?c(t._id):S.push("/")):console.log("Not Okay.");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(e,t){u((function(e){return e+t})),E("up"===e||"down"!==e&&null)},E=function(){var e=Object(d.a)(Object(b.a)().mark((function e(n){var s,c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(f,"/api/s/").concat(t.sub._id,"/posts/").concat(t._id,"/vote"),e.next=3,h(s,{value:n},k.token);case 3:c=e.sent,console.log(c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{className:"post-container",children:[C.width>800?Object(x.jsx)(F,{score:l,item:t,type:"post",handleChoice:D}):null,Object(x.jsxs)("article",{children:[Object(x.jsxs)("header",{className:"card-header",children:[Object(x.jsx)(o.b,{to:"/s/".concat(t.sub._id),className:"header-item sub-link",children:t.sub.name}),Object(x.jsx)("span",{className:"header-item",children:"Posted by"}),t.author?Object(x.jsx)(o.b,{to:"/users/".concat(t.author.username),className:"header-item profile-link",children:t.author.username}):"[Deleted]",Object(x.jsx)("span",{className:"header-item",children:V()(t.dateCreated).startOf("hour").fromNow()}),t.dateEdited?Object(x.jsxs)("span",{className:"header-item edited-item",children:["edited ",V()(t.dateEdited).startOf("hour").fromNow()]}):null]}),Object(x.jsxs)("main",{className:"card-main",children:[Object(x.jsx)("h2",{className:"post-title",children:t.title}),"video"===t.type?Object(x.jsx)("iframe",{title:t.title,className:"post-content-video",src:"https://www.youtube.com/embed/".concat(function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return!(!t||11!==t[7].length)&&t[7]}(t.content)),frameBorder:"0"}):"link"===t.type?Object(x.jsxs)("div",{children:[" ",Object(x.jsx)("a",{className:"post-content-link",href:t.content,children:t.content})]}):"image"===t.type?Object(x.jsx)("img",{className:"post-image",alt:"Post Image",src:t.content}):Object(x.jsx)("p",{className:"post-content",children:t.content})]}),Object(x.jsxs)("footer",{className:"card-footer",children:[C.width<800?Object(x.jsx)(F,{score:l,item:t,type:"post",handleChoice:D}):null,Object(x.jsxs)("span",{className:"footer-item footer-reply",children:[Object(x.jsx)(T.a,{className:"reply-bubble"}),1===t.commentCount?"1 Comment":t.commentCount+" Comments"]}),k.user&&k.user._id===t.author._id?Object(x.jsx)(o.b,{to:"/s/".concat(t.sub._id,"/posts/").concat(t._id,"/update"),className:"footer-item",children:"Edit"}):null,k.user&&k.user._id===t.author._id?Object(x.jsx)("button",{className:"footer-item",name:"delete",onClick:_,children:"Delete"}):null]})]}),n?Object(x.jsx)(o.b,{to:"/s/".concat(t.sub._id,"/posts/").concat(t._id),className:"post-link"}):null]}),v?Object(x.jsx)(J,{title:"Delete Post",message:"Are you sure you want to delete this post?",onSubmit:function(e){e?P():_()}}):null]})},W=(n(127),n(102)),H=n.n(W),Z=(n(153),function(e){var t=e.heading,n=e.color,s=e.children,c=e.footing;return Object(x.jsxs)("div",{className:"sidebar-item",children:[Object(x.jsx)("header",{className:"sidebar-item-header",style:n?{backgroundColor:n}:null,children:Object(x.jsx)("h2",{className:"heading-white",children:t})}),Object(x.jsx)("main",{className:"sidebar-item-main",children:s}),c?Object(x.jsx)("footer",{className:"sidebar-item-footer",children:c}):null]})}),$=function(e){var t=e.sub,n=e.user,c=e.score,r=w(),a=U(),i=Object(s.useState)(null),l=Object(j.a)(i,2),u=l[0],p=l[1];function h(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[n],e[n]=s}}Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("".concat(f,"/api/s/"));case 2:h((t=e.sent).subs),p(t.subs.slice(0,5));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]);var O=function(){var e=H.a.MD5(n.email.toLowerCase());return"https://www.gravatar.com/avatar/".concat(e,"?s=200&r=pg&d=mp")};return a.width>950?n?Object(x.jsxs)("div",{id:"sidebar-container",children:[Object(x.jsxs)(Z,{heading:Object(x.jsx)("img",{className:"profile-picture",src:O()}),children:[Object(x.jsx)("h2",{children:n.username}),Object(x.jsxs)("div",{className:"user-stats",children:[Object(x.jsxs)("div",{className:"user-stat-group",children:[Object(x.jsx)("h5",{className:"user-stat-label",children:"Score"}),Object(x.jsx)("span",{className:"user-stat",children:c})]}),Object(x.jsxs)("div",{className:"user-stat-group",children:[Object(x.jsx)("h5",{className:"user-stat-label",children:"Date Joined"}),Object(x.jsx)("span",{className:"user-stat",children:V()(n.dateJoined).format("MMMM DD YYYY")})]})]})]}),r.user&&r.user._id===n._id?Object(x.jsx)(Z,{heading:"Edit User Details",children:Object(x.jsxs)("div",{className:"button-box",children:[Object(x.jsx)(o.b,{to:"/users/".concat(r.user.username,"/update_email"),className:"button-filled",children:"Change Email"}),Object(x.jsx)(o.b,{to:"/users/".concat(r.user.username,"/update_password"),className:"button-outline",children:"Change Password"})]})}):null]}):Object(x.jsxs)("div",{id:"sidebar-container",children:[Object(x.jsx)(Z,{color:t?t.color:null,heading:"About Community",footing:t.dateCreated?"Created: "+V()(t.dateCreated).format("MMMM Do YYYY"):null,children:Object(x.jsx)("p",{children:t.description})}),r.user?Object(x.jsx)(Z,{heading:"Create Content",color:t?t.color:null,children:Object(x.jsxs)("div",{className:"button-box",children:[Object(x.jsx)(o.b,{to:{pathname:"/submit",state:{subID:t._id}},className:"button-filled",children:"Create Post"}),Object(x.jsx)(o.b,{to:"/s/create",className:"button-outline",children:"Create Community"})]})}):null,Object(x.jsx)(Z,{color:t?t.color:null,heading:"Other Communities",footing:Object(x.jsx)("div",{className:"button-box",children:Object(x.jsx)(o.b,{className:"button-filled",to:"/s/browse",children:"All Communities"})}),children:u?u.map((function(e){return Object(x.jsxs)("div",{className:"sub-preview",children:[Object(x.jsx)("div",{className:"small-sub-image sub-image"}),e.name,Object(x.jsx)(o.b,{to:"/s/".concat(e._id),className:"sub-preview-link"},e._id)]},e._id)})):null})]}):null},G=(n(154),function(){return Object(x.jsxs)("div",{className:"lds-facebook",children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})}),K=n(282),Q=function(){var e=w(),t=Object(s.useState)(null),n=Object(j.a)(t,2),c=n[0],r=n[1];Object(s.useEffect)((function(){var t=function(){var t=Object(d.a)(Object(b.a)().mark((function t(){var n;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m("".concat(f,"/api/s/user/posts/home"),e.token);case 3:n=t.sent,r(n.posts),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m("".concat(f,"/api/s/home/posts/"));case 3:t=e.sent,r(t.posts),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e.user?t():n()}),[e.user,e.token]);var a=function(e){var t=c.filter((function(t){return t._id!==e}));r(t)};return Object(x.jsx)("div",{className:"sub-container",children:c?Object(x.jsxs)("main",{className:"sub-page",children:[Object(x.jsx)("div",{className:"posts-container",children:c.length>0?c.map((function(e){return Object(x.jsx)(z,{post:e,link:!0,handleRemove:a},e._id)})):Object(x.jsxs)("div",{className:"empty-sub",children:[Object(x.jsx)("h1",{children:"Subscribe to communities to get started"}),Object(x.jsx)(K.a,{className:"empty-sub-icon"}),Object(x.jsx)(o.b,{to:"/s/browse",className:"button-filled",children:"Browse Communities"})]})}),Object(x.jsx)($,{sub:e.user?{name:"Homepage",description:"Your personalized homepage"}:{name:"All",description:"All the newest posts from every community"}})]}):Object(x.jsx)(G,{})})},X=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m("".concat(f,"/api/s/home/posts/"));case 3:t=e.sent,c(t.posts),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(x.jsx)("div",{className:"sub-container",children:n?Object(x.jsxs)("main",{className:"sub-page",children:[Object(x.jsx)("div",{className:"posts-container",children:n.map((function(e){return Object(x.jsx)(z,{post:e,link:!0},e._id)}))}),Object(x.jsx)($,{sub:{name:"All",description:"This is a collection of all the communities newest posts"}})]}):Object(x.jsx)(G,{})})},ee=(n(155),n(156),n(157),function(e){var t=e.subData,n=w(),c=y(),r=Object(s.useState)(null),a=Object(j.a)(r,2),o=a[0],i=a[1];Object(s.useEffect)((function(){n.user.subscriptions.some((function(e){return e===t._id}))&&i(!0)}),[t,n.user]);var l=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(f,"/api/s/").concat(t._id,"/subscribe"),{body:""},n.token);case 3:e.sent.ok?(c.changeMessage("Now subscribed to ".concat(t.name)),n.subscribe(t._id)):console.log("something went wrong"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(f,"/api/s/").concat(t._id,"/unsubscribe"),{body:""},n.token);case 3:e.sent.ok?(c.changeMessage("Unsubscribed from ".concat(t.name)),n.unsubscribe(t._id)):console.log("something went wrong"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=6;break}return i(!1),e.next=4,u();case 4:e.next=9;break;case 6:return i(!0),e.next=9,l();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"subscribe-button-container",children:Object(x.jsx)("button",{onClick:function(){m()},onMouseOver:function(e){e.target.textContent=o?"Leave":"Join?"},onMouseLeave:function(e){e.target.textContent=o?"Joined":"Join"},className:o?"button-outline subscribe-button":"button-filled subscribe-button",children:o?"Joined":"Join"})})}),te=n(283),ne=function(e){var t=e.subData,n=w();return Object(x.jsxs)("header",{className:"sub-header-container",children:[Object(x.jsx)("div",{className:"community-theme",style:t.color?{backgroundColor:t.color}:null}),Object(x.jsx)("div",{className:"lower-header-container",children:Object(x.jsxs)("div",{className:"header-main-container",children:[Object(x.jsx)("div",{className:"sub-image"}),Object(x.jsxs)("div",{className:"header-sub-container",children:[Object(x.jsx)("div",{className:"sub-title-container",children:Object(x.jsx)("h1",{className:"sub-title",children:t.name})}),Object(x.jsxs)("div",{className:"sub-header-buttons",children:[n.user?Object(x.jsx)(ee,{subData:t}):null,n.user&&t.creator===n.user._id?Object(x.jsx)(o.b,{to:"/s/".concat(t._id,"/update"),className:"button-filled nav-button",children:Object(x.jsx)(te.a,{className:"button-icon"})}):null]})]})]})})]})},se=function(){var e=Object(i.i)().subID,t=Object(s.useState)(null),n=Object(j.a)(t,2),c=n[0],r=n[1],a=Object(s.useState)(!1),l=Object(j.a)(a,2),p=l[0],h=l[1];Object(s.useEffect)((function(){var t=function(){var t=Object(d.a)(Object(b.a)().mark((function t(){var n;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h(!0),t.next=3,m("".concat(f,"/api/s/").concat(e));case 3:n=t.sent,r({sub:n.sub,posts:n.posts}),h(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]);var O=function(e){var t=c.posts.filter((function(t){return t._id!==e}));r(Object(u.a)(Object(u.a)({},c),{},{posts:t}))};return p?Object(x.jsx)(G,{}):c?Object(x.jsxs)("div",{className:"sub-container",children:[Object(x.jsx)(ne,{subData:c.sub}),Object(x.jsxs)("main",{className:"sub-page",children:[Object(x.jsx)("div",{className:"posts-container",children:c.posts.length>0?c.posts.map((function(e){return Object(x.jsx)(z,{post:e,link:"true",handleRemove:O},e._id)})):Object(x.jsxs)("div",{className:"empty-sub",children:[Object(x.jsx)("h1",{children:"No Posts Yet!"}),Object(x.jsx)(K.a,{className:"empty-sub-icon"}),Object(x.jsx)(o.b,{to:{pathname:"/submit",state:{subID:c.sub._id}},className:"button-filled",children:"Create Post"})]})}),Object(x.jsx)($,{sub:c.sub})]})]}):null},ce=(n(158),n(16)),re=n(18),ae=n(6),oe=n(50),ie=(n(64),["name","label","error"]),le=c.a.forwardRef((function(e,t){var n=e.name,s=e.label,c=e.error,r=Object(oe.a)(e,ie);return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"form-group-label",htmlFor:n,children:s}),Object(x.jsx)("input",Object(u.a)(Object(u.a)({className:c?"form-group-input-error":"form-group-input",name:n},r),{},{ref:t})),c?Object(x.jsx)("span",{className:"error",children:c}):null]})})),ue=(n(257),function(e){var t=e.handleSubmit,n=e.title,s=e.error,c=e.art,r=e.button,a=e.children;return Object(x.jsxs)("div",{className:"form-container",children:[Object(x.jsx)("div",{className:"form-art art".concat(c)}),Object(x.jsxs)("form",{className:"formy-form",onSubmit:t,children:[Object(x.jsx)("h2",{className:"form-heading",children:n}),s?Object(x.jsx)("div",{className:"error-block",children:s}):null,a,Object(x.jsx)("input",{type:"submit",className:"button-filled",value:r})]})]})}),be=c.a.forwardRef((function(e,t){var n=e.name,s=e.label,c=e.placeholder,r=e.error;return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"form-group-label",htmlFor:n,children:s}),Object(x.jsx)("textarea",{className:r?"form-group-textarea-error":"form-group-textarea",name:n,placeholder:c,ref:t}),r?Object(x.jsx)("span",{className:"error",children:r}):null]})})),de=c.a.forwardRef((function(e,t){var n=e.name,s=e.label,c=e.defaultValue,r=e.optionsArray,a=e.error;return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:n,className:"form-group-label",children:s}),Object(x.jsx)("select",{name:n,defaultValue:c,ref:t,children:r.map((function(e){return Object(x.jsx)("option",{value:e._id,children:e.name},e._id)}))}),a?Object(x.jsx)("span",{className:"error",children:a}):null]})})),je=function(e){var t=e.edit,n=Object(i.h)();console.log(n);var c=w(),r=y(),a=Object(i.g)(),o=Object(i.i)()||"",l=o.subID,u=o.postID,O=Object(s.useState)("text"),v=Object(j.a)(O,2),g=v[0],N=v[1],k=Object(s.useState)(null),C=Object(j.a)(k,2),S=C[0],_=C[1],P=Object(s.useState)(null),D=Object(j.a)(P,2),E=D[0],M=D[1];Object(s.useEffect)((function(){}),[g]);var q=Object(ce.b)({resolver:Object(re.a)("text"===g?ae.a().shape({title:ae.c().required("Title is required").min(3).max(300).trim(),content:ae.c().max(2e3).trim()}):"image"===g?ae.a().shape({title:ae.c().required("Title is required").min(3).max(300).trim(),image:ae.c().url("Something doesn't look right").required("Valid URL is required").max(100).min(1).trim()}):"video"===g?ae.a().shape({title:ae.c().required("Title is required").min(3).max(300).trim(),video:ae.c().url("Something doesn't look right").required("A link is required").matches(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,{message:"Must be a valid YouTube URL"}).max(100).min(1).trim()}):ae.a().shape({title:ae.c().required("Title is required").min(3).max(300).trim(),link:ae.c().url("Something doesn't look right").required("Valid URL is required").max(100).min(1).trim()})),shouldUnregister:!1}),I=q.register,A=q.handleSubmit,L=q.errors,T=q.setValue;Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("".concat(f,"/api/s/user"),c.token);case 2:t=e.sent,_(t.subs);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t||e()}),[c.token,t]),Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("".concat(f,"/api/s/").concat(l,"/posts/").concat(u));case 2:t=e.sent,console.log(t),t.post.type&&N(t.post.type),t.post.type&&"video"===t.post.type&&T(t.post.type,t.post.content,{shouldValidate:!0}),T("title",t.post.title,{shouldValidate:!0});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t&&e()}),[t,u,T,l]);var U=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p("".concat(f,"/api/s/").concat(l,"/posts/create"),t,c.token);case 2:(n=e.sent).post?(r.changeMessage(n.message),a.push("/s/".concat(t.sub,"/posts/").concat(n.post._id))):M("Something went wrong");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(f,"/api/s/").concat(l,"/posts/").concat(u,"/update"),e.next=4,h(n,t,c.token);case 4:e.sent.ok?(r.changeMessage("Post updated successfully"),a.push("/s/".concat(t.sub,"/posts/").concat(u))):M("Something went wrong"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log({message:"something went wrong",error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),V=function(e){N(e.target.name)};return Object(x.jsxs)(ue,{handleSubmit:A((function(e){var n=e,s=n.title,c=n.sub,r=n.content,a=n.video,o=n.link,i=n.image;e="video"===g?{title:s,content:a,type:g,sub:c}:"image"===g?{title:s,sub:c,type:g,content:i}:"link"===g?{title:s,sub:c,type:g,content:o}:{title:s,sub:c,type:g,content:r},t?R(e):U(e)})),title:t?"Edit Post":"Create Post",error:E,art:"1",button:t?"Save Changes":"Create Post",children:[Object(x.jsxs)("div",{className:"type-selector",children:[Object(x.jsx)("button",{type:"button",name:"text",onClick:V,className:"text"===g?"type-selection selected":"type-selection",children:"Text"}),Object(x.jsxs)("button",{type:"button",name:"image",onClick:V,className:"image"===g?"type-selection selected":"type-selection",children:[" ","Image"]}),Object(x.jsx)("button",{type:"button",name:"video",onClick:V,className:"video"===g?"type-selection selected":"type-selection",children:"Video"}),Object(x.jsx)("button",{type:"button",name:"link",onClick:V,className:"link"===g?"type-selection selected":"type-selection",children:"Link"})]}),S?Object(x.jsx)(de,{name:"sub",label:"Community",defaultValue:n.state?n.state.subID:null,optionsArray:S,ref:I,error:L.sub?L.sub.message:null}):null,Object(x.jsx)(le,{name:"title",type:"text",label:"Title",placeholder:"What did you want everyone to know about?",ref:I,error:L.title?L.title.message:null}),"text"===g?Object(x.jsx)(be,{name:"content",label:"Content",placeholder:"optional",ref:I,error:L.content?L.content.message:null}):"video"===g?Object(x.jsx)(le,{name:"video",type:"text",label:"YouTube Video",placeholder:"Please include the full url",ref:I,error:L.video?L.video.message:null}):"link"===g?Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"form-group-label",htmlFor:"link",children:"Link"}),Object(x.jsx)("input",{className:L.link?"form-group-input-error":"form-group-input",name:"link",type:"text",placeholder:"Please include the full url",ref:I}),L.link?Object(x.jsx)("span",{className:"error",children:L.link.message}):null]}):Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"form-group-label",htmlFor:"image",children:"Image Link"}),Object(x.jsx)("input",{className:L.image?"form-group-input-error":"form-group-input",name:"image",type:"text",placeholder:"Please include the full url",ref:I}),L.image?Object(x.jsx)("span",{className:"error",children:L.image.message}):null]})]})},me=function(e){var t=e.edit,n=(Object(i.i)()||"").subID,c=w(),r=y(),a=Object(i.g)(),o=Object(s.useState)(null),l=Object(j.a)(o,2),u=l[0],O=l[1],v=Object(ce.b)({resolver:Object(re.a)(t?ae.a().shape({description:ae.c().required().min(6).max(600)}):ae.a().shape({name:ae.c().required().min(3).max(20).trim().matches(/^[_a-zA-Z0-9]*$/,{message:"cannot contain special characters or spaces"}),description:ae.c().required().min(6).max(600)}))}),g=v.register,N=v.handleSubmit,k=v.setValue,C=v.errors;Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("".concat(f,"/api/s/").concat(n,"\n      "));case 2:t=e.sent,k("name",t.sub.name),k("description",t.sub.description),k("color",t.sub.color);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t&&e()}),[t,k,n]);var S=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p("".concat(f,"/api/s/create"),t,c.token);case 3:(n=e.sent).errors?O(n.errors[0].msg):n.sub&&r.changeMessage("New community created!"),a.push("/s/".concat(n.sub._id)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),O(e.t0),console.log("something wrong in sub creation");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat(f,"/api/s/").concat(n,"/update"),t,c.token);case 3:e.sent.ok?a.push("/s/".concat(n)):console.log("errorsss"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),O(e.t0),console.log("something wrong in sub creation");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(ue,{handleSubmit:N((function(e){t?_(e):S(e)})),title:t?"Update Community":"Create Community",error:u,art:"1",button:t?"Save Changes":"Create Community",children:[Object(x.jsx)(le,{name:"name",label:"Community Name",type:"text",placeholder:"3-20 characters",disabled:t?"disabled":null,ref:g,error:C.name?C.name.message:null}),Object(x.jsx)(be,{name:"description",label:"Description",placeholder:"min 6 characters",ref:g,error:C.description?C.description.message:null}),Object(x.jsx)(le,{name:"color",label:"Community Color",type:"color",ref:g})]})},pe=(n(258),n(259),n(260),ae.a().shape({content:ae.c().required().min(1).max(600)})),he=function(e){var t=w(),n=y(),c=e.parentComment,r=e.refreshPost,a=e.handleForm,l=e.edit,u=Object(i.i)(),j=u.subID,m=u.postID,O=c?c._id:null,v=Object(ce.b)({resolver:Object(re.a)(pe)}),g=v.register,N=v.handleSubmit,k=v.errors,C=v.setValue;Object(s.useEffect)((function(){l&&C("content",c.content,{shouldValidate:!0})}),[c,l,C]);var S=function(){var e=Object(d.a)(Object(b.a)().mark((function e(s){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c?console.log(!0):console.log(!1),e.next=4,p("".concat(f,"/api/s/").concat(j,"/posts/").concat(m,"/comments/create"),c?{content:s,parent:c._id}:{content:s},t.token);case 4:e.sent.comment&&(n.changeMessage("Comment created successfully"),r()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(Object(b.a)().mark((function e(s){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c="".concat(f,"/api/s/").concat(j,"/posts/").concat(m,"/comments/").concat(O,"/update"),e.next=4,h(c,{content:s},t.token);case 4:e.sent.ok?(n.changeMessage("Comment edited successfully"),r()):n.changeMessage("Oops! Something went wrong."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return t.user?Object(x.jsxs)("form",{className:"comment-form",onSubmit:N((function(e){var t=e.content;l?_(t):S(t)})),children:[Object(x.jsx)(be,{name:"content",placeholder:"What are your thoughts?",ref:g,error:k.content?k.content.message:null}),Object(x.jsxs)("div",{className:"form-button-container",children:[c?Object(x.jsx)("button",{className:"button-outline",id:"cancel-form",onClick:function(e){e.preventDefault(),a(e)},children:"Cancel"}):null,Object(x.jsx)("button",{className:"button-filled",onClick:N,children:l?"Edit":"Comment"})]})]}):Object(x.jsxs)("div",{className:"no-user-box",children:[Object(x.jsx)("span",{children:"Log in or sign up to leave a comment"}),Object(x.jsxs)("div",{className:"nav-buttons",children:[Object(x.jsx)(o.b,{to:"/signup",className:"button-outline nav-button",children:"Sign Up"}),Object(x.jsx)(o.b,{to:"/login",className:"button-filled nav-button",children:"Log In"})]})]})},Oe=(n(261),function(e){var t=e.comment,n=e.post,c=e.refreshPost,r=e.layer,a=e.handleRemove,i=e.children,l=y(),u=w(),m=Object(s.useState)(!1),p=Object(j.a)(m,2),v=p[0],g=p[1],N=Object(s.useState)(!1),k=Object(j.a)(N,2),C=k[0],S=k[1],_=Object(s.useState)(t.score),P=Object(j.a)(_,2),D=P[0],E=P[1],M=Object(s.useState)(!1),q=Object(j.a)(M,2),I=q[0],A=q[1],L=function(e){"delete"===e.target.name?R():("edit"===e.target.name&&S(!0),v?(g(!1),S(!1)):g(!0))},U=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var s,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(f,"/api/s/").concat(n?n.sub._id:t.post.sub,"/posts/").concat(n?n._id:t.post._id,"/comments/").concat(t._id,"/delete"),e.next=3,O(s,u.token);case 3:r=e.sent,console.log(r),r.ok?(a?a(t._id):c(),l.changeMessage("Comment Deleted")):l.changeMessage("Oops! Something went wrong!");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){A(!I)},B=function(){var e=Object(d.a)(Object(b.a)().mark((function e(s){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(f,"/api/s/").concat(n.sub._id,"/posts/").concat(n._id,"/comments/").concat(t._id,"/vote"),e.next=3,h(c,{value:s},u.token);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:t.parent?"comment-reply":"comment-container",children:[I?Object(x.jsx)(J,{title:"Delete Comment",message:"Are you sure you want to delete this comment?",onSubmit:function(e){e?U():R()}}):null,Object(x.jsxs)("div",{className:"comment",children:[t.author?Object(x.jsx)(F,{score:D,item:t,type:"comment",handleChoice:function(e,t){E((function(e){return e+t})),B("up"===e||"down"!==e&&null)}}):null,Object(x.jsxs)("article",{children:[Object(x.jsxs)("header",{className:"card-header",children:[t.author?Object(x.jsx)(o.b,{className:"header-item profile-link",to:"/users/".concat(t.author.username),children:t.author.username}):Object(x.jsx)("span",{className:"header-item",children:"[deleted]"}),Object(x.jsx)("span",{className:"header-item",children:1===D?D+" point":D+" points"}),Object(x.jsxs)("span",{className:"header-item",children:["- ",V()(t.dateCreated).startOf("hour").fromNow()]}),t.dateEdited?Object(x.jsxs)("span",{className:"header-item edited-item",children:["edited ",V()(t.dateEdited).startOf("hour").fromNow()]}):null]}),Object(x.jsx)("main",{className:"card-main",children:Object(x.jsx)("span",{children:t.content?t.content:"[deleted]"})}),u.user&&t.author?Object(x.jsxs)("footer",{className:"card-footer",children:[r<6?Object(x.jsxs)("button",{onClick:L,className:"footer-item",children:[Object(x.jsx)(T.a,{className:"reply-bubble"}),"Reply"]}):null,u.user&&u.user._id===t.author._id?Object(x.jsxs)("div",{className:"footer-button-container",children:[Object(x.jsx)("button",{className:"footer-item",name:"edit",onClick:L,children:"Edit"}),Object(x.jsx)("button",{className:"footer-item",name:"delete",onClick:L,children:"Delete"})]}):null]}):null,v?Object(x.jsx)(he,{post:n,parentComment:t,refreshPost:c,handleForm:L,edit:C}):null]})]}),i]})}),fe=function(e){var t=e.comments,n=e.post,s=e.refreshPost;return Object(x.jsxs)("div",{id:"comments-container",children:[Object(x.jsx)("h3",{children:"Leave A Comment"}),Object(x.jsx)("div",{children:Object(x.jsx)(he,{post:n,refreshPost:s})}),Object(x.jsx)("div",{id:"comments-index",children:t?function e(t,c){return t.map((function(t){return Object(x.jsx)(Oe,{comment:t,post:n,refreshPost:s,layer:c,children:t.replies?e(t.replies,c+1):null},t._id)}))}(t,1):null})]})},xe=function(){var e=Object(i.i)(),t=e.subID,n=e.postID,c=Object(s.useState)(null),r=Object(j.a)(c,2),a=r[0],o=r[1],l=Object(s.useState)(!1),u=Object(j.a)(l,2),p=u[0],h=u[1];Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var s;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,m("".concat(f,"/api/s/").concat(t,"/posts/").concat(n));case 3:s=e.sent,o(s.post),h(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[n,t]);var O=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var s;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,m("".concat(f,"/api/s/").concat(t,"/posts/").concat(n));case 3:s=e.sent,o(s.post),h(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{children:p?Object(x.jsx)(G,{}):a?Object(x.jsxs)("div",{className:"post-details-container",children:[Object(x.jsxs)("div",{className:"post-details",children:[Object(x.jsx)(z,{post:a}),Object(x.jsx)(fe,{comments:a.comments,post:a,refreshPost:O})]}),Object(x.jsx)($,{sub:a.sub})]}):null})},ve=ae.a().shape({username:ae.c().required("A username is required").min(3,"Usernames must be between 3-20 characters in length").max(20,"Usernames must be between 3-20 characters in length").trim().matches(/^[_a-zA-Z0-9]*$/,{message:"cannot contain special characters or spaces"}),password:ae.c().required("Password is required").min(6).max(40),password2:ae.c().required("Please re-enter password").oneOf([ae.b("password"),null],"Passwords must match"),email:ae.c().required("An email is required").email("Must be a valid email")}),ge=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1],r=w(),a=y(),o=Object(i.g)(),l=Object(ce.b)({resolver:Object(re.a)(ve)}),u=l.register,m=l.handleSubmit,p=l.errors,h=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n,s,i,l;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,s=t.password,i=t.email,e.prev=1,e.next=4,r.signup(n,s,i);case 4:(l=e.sent).user?(a.changeMessage("Account created successfully! Please log in."),o.push("/login")):l.errors?(console.log(l),c(l.errors[0].msg)):c("Something went wrong."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),c(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(ue,{handleSubmit:m(h),title:"Sign Up",error:n,art:"2",button:"Create Account",children:[Object(x.jsx)(le,{name:"username",label:"Username",type:"text",placeholder:"",ref:u,error:p.username?p.username.message:null}),Object(x.jsx)(le,{name:"email",label:"Email",type:"text",placeholder:"example@example.com",ref:u,error:p.email?p.email.message:null}),Object(x.jsx)(le,{name:"password",label:"Password",type:"password",placeholder:"",ref:u,error:p.password?p.password.message:null}),Object(x.jsx)(le,{name:"password2",label:"Confirm Password",type:"password",placeholder:"",ref:u,error:p.password2?p.password2.message:null})]})},we=ae.a().shape({username:ae.c().required().min(3).max(20).trim(),password:ae.c().required().min(6).max(40).trim()}),Ne=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1],r=Object(i.g)(),a=(Object(i.h)().state||{from:{pathname:"/"}}).from,o=w(),l=y(),u=Object(ce.b)({resolver:Object(re.a)(we)}),m=u.register,p=u.handleSubmit,h=u.errors,O=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n,s,i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,s=t.password,e.next=3,o.login(n,s);case 3:(i=e.sent).user||c(i.message),i.user&&(r.replace(a),l.changeMessage("Welcome back ".concat(i.user.username)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(ue,{handleSubmit:p(O),title:"Log In",error:n,art:"2",button:"Log In",children:[Object(x.jsx)(le,{name:"username",label:"Username",type:"text",placeholder:"",ref:m,error:h.username?h.username.message:null}),Object(x.jsx)(le,{name:"password",label:"Password",type:"password",ref:m,error:h.password?h.password.message:null})]})},ke=(n(262),function(){var e=U(),t=(Object(i.i)()||"").username,n=Object(s.useState)("posts"),c=Object(j.a)(n,2),r=c[0],a=c[1],o=Object(s.useState)(null),l=Object(j.a)(o,2),p=l[0],h=l[1];Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m("".concat(f,"/api/users/").concat(t));case 3:n=e.sent,h(n.user),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]);var O=function(e){"posts"===e.target.name?a("posts"):a("comments")},v=function(e){var t=p.posts.filter((function(t){return t._id!==e}));h(Object(u.a)(Object(u.a)({},p),{},{posts:t}))},g=function(e){var t=p.comments.filter((function(t){return t._id!==e}));h(Object(u.a)(Object(u.a)({},p),{},{comments:t}))};return p?Object(x.jsxs)("div",{className:"user-profile-container",children:[Object(x.jsxs)("nav",{className:"profile-nav",children:[Object(x.jsxs)("button",{onClick:O,name:"posts",className:"type-selection",style:"posts"===r?{borderBottom:"2px solid #222"}:null,children:["Posts (",p.posts.length,")"]}),Object(x.jsxs)("button",{onClick:O,name:"comments",className:"type-selection",style:"comments"===r?{borderBottom:"2px solid #222"}:null,children:["Comments (",p.comments.length,")"]})]}),Object(x.jsx)("div",{className:"user-profile-content",children:"posts"===r?p.posts.map((function(e){return Object(x.jsx)(z,{post:e,link:"true",handleRemove:v},e._id)})):p.comments.map((function(e){return Object(x.jsxs)("div",{className:"comment-box",children:[Object(x.jsx)("div",{children:e.post?Object(x.jsxs)("span",{children:[e.post.title," posted by ",e.post.author.username]}):Object(x.jsx)("span",{children:"deleted"})}),Object(x.jsx)(Oe,{comment:e,handleRemove:g})]},e._id)}))}),e.width>800?Object(x.jsx)("div",{className:"user-details",children:Object(x.jsx)($,{user:p,score:function(){var e=0;return p.posts.forEach((function(t){return e+=t.score})),p.comments.forEach((function(t){return e+=t.score})),e}()})}):null]}):Object(x.jsx)(G,{})}),ye=(n(263),function(){var e=w(),t=Object(s.useState)(null),n=Object(j.a)(t,2),c=n[0],r=n[1],a=Object(s.useState)(!1),i=Object(j.a)(a,2),l=i[0],u=i[1];return Object(s.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,m("".concat(f,"/api/s/"));case 3:t=e.sent,r(t.subs),u(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(x.jsxs)("div",{id:"sub-index-container",children:[Object(x.jsxs)("header",{id:"sub-index-header",children:[Object(x.jsx)("h3",{className:"white-heading",children:"Browse Communities"}),Object(x.jsx)(o.b,{to:"create",className:"button-outline nav-button",children:"Create Community"})]}),Object(x.jsx)("div",{id:"sub-index",children:l?Object(x.jsx)(G,{}):c?c.map((function(t){return Object(x.jsxs)("div",{className:"sub-preview-large",children:[Object(x.jsxs)("div",{className:"preview-name-box",children:[" ",Object(x.jsx)("div",{className:"sub-circle",style:t.color?{backgroundColor:t.color}:null}),Object(x.jsx)("span",{className:"sub-name preview-item",children:t.name})]}),e.user?Object(x.jsx)(ee,{subData:t}):null,Object(x.jsx)(o.b,{to:"".concat(t._id),className:"sub-preview-link"},t._id)]})})):null})]})}),Ce=(n(264),ae.a().shape({oldPassword:ae.c().required("Please enter your old password").min(6).max(40),password:ae.c().required("New password is required").min(6).max(40),password2:ae.c().required("Please re-enter password").oneOf([ae.b("password"),null],"Passwords must match")})),Se=ae.a().shape({email:ae.c().required("An email is required").email("Must be a valid email")}),_e=function(e){var t=e.email,n=Object(s.useState)(null),c=Object(j.a)(n,2),r=c[0],a=c[1],o=w(),l=y(),u=Object(i.g)(),m=Object(ce.b)({resolver:t?Object(re.a)(Se):Object(re.a)(Ce)}),p=m.register,O=m.handleSubmit,v=m.errors,g=function(e){console.log(e),t?k(e):N(e)},N=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n,s,c,r,i,d;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.oldPassword,s=t.password,c=t.password2,r="".concat(f,"/api/users/").concat(o.user.username,"/update_password"),e.prev=2,e.next=5,h(r,{oldPassword:n,password:s,password2:c},o.token);case 5:if(!(i=e.sent).ok){e.next=11;break}l.changeMessage("Password successfully updated"),u.push("/users/".concat(o.user.username)),e.next=16;break;case 11:return e.next=13,i.json();case 13:(d=e.sent).errors&&a(d.errors[0].msg),console.log({response:i,data:d});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(Object(b.a)().mark((function e(t){var n,s,c,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,s="".concat(f,"/api/users/").concat(o.user.username,"/update_email"),e.prev=2,e.next=5,h(s,{email:n},o.token);case 5:if(!(c=e.sent).ok){e.next=11;break}l.changeMessage("Email successfully updated"),u.push("/users/".concat(o.user.username)),e.next=16;break;case 11:return e.next=13,c.json();case 13:(r=e.sent).errors&&a(r.errors[0].msg),console.log(c);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}();return t?Object(x.jsx)(ue,{handleSubmit:O(g),title:"Change Email Address",error:r,art:"2",button:"Update Email",children:Object(x.jsx)(le,{name:"email",label:"New Email",type:"text",placeholder:"example@example.com",ref:p,error:v.email?v.email.message:null})}):Object(x.jsxs)(ue,{handleSubmit:O(g),title:"Change Password",error:r,art:"2",button:"Update Password",children:[Object(x.jsx)(le,{name:"oldPassword",label:"Old Password",type:"text",placeholder:"",ref:p,error:v.oldPassword?v.oldPassword.message:null}),Object(x.jsx)(le,{name:"password",label:"New Password",type:"password",placeholder:"",ref:p,error:v.password?v.password.message:null}),Object(x.jsx)(le,{name:"password2",label:"Confirm Password",type:"password",placeholder:"",ref:p,error:v.password2?v.password2.message:null})]})},Pe=(n(265),function(){var e=y();return e.showMessage?Object(x.jsxs)("div",{className:"flash-container",children:[Object(x.jsx)("aside",{className:"blue-bar"}),Object(x.jsx)("span",{className:"flash-message",children:e.message})]}):null}),De=["children"],Ee=function(e){var t=e.children,n=Object(oe.a)(e,De),s=w();return Object(x.jsx)(i.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){var n=e.location;return s.user?t:Object(x.jsx)(i.a,{to:{pathname:"/login",state:{from:n}}})}}))};var Me=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(g,{children:Object(x.jsxs)(k,{children:[Object(x.jsx)(Pe,{}),Object(x.jsxs)(o.a,{children:[Object(x.jsx)(L,{}),Object(x.jsx)("main",{id:"main-container",children:Object(x.jsxs)(i.d,{children:[Object(x.jsx)(Ee,{path:"/users/:username/update_email",children:Object(x.jsx)(_e,{email:!0})}),Object(x.jsx)(Ee,{path:"/users/:username/update_password",children:Object(x.jsx)(_e,{})}),Object(x.jsx)(i.b,{path:"/users/:username",children:Object(x.jsx)(ke,{})}),Object(x.jsx)(Ee,{path:"/s/:subID/update",children:Object(x.jsx)(me,{edit:!0})}),Object(x.jsx)(Ee,{path:"/s/:subID/posts/:postID/update",children:Object(x.jsx)(je,{edit:!0})}),Object(x.jsx)(i.b,{path:"/s/:subID/posts/:postID",children:Object(x.jsx)(xe,{})}),Object(x.jsx)(Ee,{path:"/s/:subID/submit",children:Object(x.jsx)(je,{})}),Object(x.jsx)(Ee,{path:"/s/create",children:Object(x.jsx)(me,{})}),Object(x.jsx)(i.b,{path:"/s/browse",children:Object(x.jsx)(ye,{})}),Object(x.jsx)(i.b,{path:"/s/all",children:Object(x.jsx)(X,{})}),Object(x.jsx)(i.b,{path:"/s/:subID",children:Object(x.jsx)(se,{})}),Object(x.jsx)(Ee,{path:"/submit",children:Object(x.jsx)(je,{})}),Object(x.jsx)(i.b,{path:"/login",children:Object(x.jsx)(Ne,{})}),Object(x.jsx)(i.b,{path:"/signup",children:Object(x.jsx)(ge,{})}),Object(x.jsx)(Ee,{path:"/home",children:Object(x.jsx)(Q,{})}),Object(x.jsx)(i.b,{path:"/",children:Object(x.jsx)(Q,{})})]})})]})]})})})},qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,284)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),r(e),a(e)}))};a.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(Me,{})}),document.getElementById("root")),qe()},64:function(e,t,n){}},[[266,1,2]]]);
//# sourceMappingURL=main.4ecc4daa.chunk.js.map